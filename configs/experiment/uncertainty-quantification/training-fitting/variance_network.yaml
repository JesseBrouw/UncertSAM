name: "variance_network"

sam_model: "SAM2_large"

resume_from_checkpoint_path: null

base_lr: 1.0e-4
weight_decay: 1.0e-4
grad_clip_norm: 0.1
phases_per_epoch: 1
max_epochs: 1
batch_size: 1
max_num_objects: 32
seed: 42

multistep_training: true
preturb_prompts: true

eval_transforms:
  - _target_: src.uncertsam2.data.transforms.ComposeAPI
    transforms:
      - _target_: src.uncertsam2.data.transforms.RandomResizeAPI
        sizes: 1024
        square: true
        consistent_transform: True
      - _target_: src.uncertsam2.data.transforms.ToTensorAPI
      - _target_: src.uncertsam2.data.transforms.NormalizeAPI
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]

# Use Same transforms as SAM 2 used during training on images
train_transforms:
  - _target_: src.uncertsam2.data.transforms.ComposeAPI
    transforms:
      - _target_: src.uncertsam2.data.transforms.RandomHorizontalFlip
        consistent_transform: True
      - _target_: src.uncertsam2.data.transforms.RandomResizeAPI
        sizes: 1024
        square: true
        consistent_transform: True
      - _target_: src.uncertsam2.data.transforms.ToTensorAPI
      - _target_: src.uncertsam2.data.transforms.NormalizeAPI
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
